(this["webpackJsonpe-commerce-client"]=this["webpackJsonpe-commerce-client"]||[]).push([[0],{1003:function(e,t,a){},1004:function(e,t,a){},1005:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(49),o=a.n(s),l=a(1023),c=a(21),i=a(410),m=a(109),u=a(1012),p=a(523),d=a.n(p),h=a(223);const E=e=>e.ok?e:e.headers.has("content-type")&&e.headers.get("content-type").startsWith("application/json")?e.json().then(e=>Promise.reject(e)):Promise.reject({code:e.status,message:e.statusText}),g=(e,t)=>({type:"SET_AUTH_TOKEN",token:e,refreshToken:t}),v=e=>({type:"AUTH_ERROR",error:e}),y=(e,t,a)=>{const n=d()(e);a(g(e,t)),a({type:"AUTH_SUCCESS",currentUser:n}),localStorage.setItem("token",e),localStorage.setItem("refresh_token",t)},f=(e,t)=>a=>(a({type:"AUTH_REQUEST"}),fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(e=>E(e)).then(e=>e.json()).then(({token:e,refresh_token:t})=>y(e,t,a)).catch(e=>{const t=401===e.code?"Incorrect email or password":"Unable to login, please try again";return a(v(e)),Promise.reject(new h.a({_error:t}))})),b=()=>(e,t)=>{e({type:"AUTH_REQUEST"});const a=t().auth.refreshToken;return fetch("/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:a})}).then(e=>E(e)).then(e=>e.json()).then(({token:t,refresh_token:a})=>y(t,a,e)).catch(t=>{console.error(t),e(v(t)),e({type:"CLEAR_AUTH"}),localStorage.removeItem("token")})};var C=a(334);const x=Object(n.createContext)();class O extends n.Component{constructor(e){super(e),this.state={loading:null,timeout:null,results:[],fetchResults:this.fetchResults.bind(this),setResults:e=>this.setState({results:e}),clearResults:()=>this.setState({results:[]})}}fetchResults(e){this.setState({loading:!0}),clearTimeout(this.state.timeout),this.setState({timeout:setTimeout(()=>{fetch("".concat("/api","/products?name=").concat(e)).then(e=>e.json()).then(e=>{this.setState({loading:!1,results:e["hydra:member"]})})},500)})}render(){return r.a.createElement(x.Provider,{value:this.state},this.props.children)}}class S extends n.Component{handleChange(e){let t=e.target;t.value.trim().length>=1?this.context.fetchResults(t.value):this.context.clearResults()}render(){return r.a.createElement("input",{id:"searchBar",type:"text",placeholder:"Search...",onChange:this.handleChange.bind(this)})}}S.contextType=x;var j=a(47);class P extends n.Component{addCart(e){this.props.dispatch({type:"ADD_PRODUCT",product:Object(j.a)({},e,{quantity:1})})}render(){let e=this.props,t=e.id,a=e.name,n=e.price,s=e.description;return r.a.createElement("div",{className:"SearchResultItem"},r.a.createElement("img",{style:{marginRight:15,marginLeft:5,borderRadius:15},src:"https://fakeimg.pl/80x80/282828/F2F4F3",alt:""}),r.a.createElement("div",null,r.a.createElement("h4",null,r.a.createElement(C.a,{onClick:this.props.hideResults,to:"/product/".concat(t)},a)),r.a.createElement("p",{style:{fontSize:"0.7rem",textAlign:"justify",margin:"5px 0 11px"}},s),r.a.createElement("div",null,r.a.createElement("p",{style:{float:"left"}},n," \u20ac"),r.a.createElement("button",{className:"addToCart",onClick:()=>this.addCart(this.props)},"Ajouter au panier"))))}}P.contextType=x;var T=Object(c.connect)()(P);class N extends n.Component{render(){return!1===this.context.loading&&this.context.results.length>=1?r.a.createElement("div",{ref:this.mount,className:"resultSearchBar"},this.context.results.map(e=>r.a.createElement(T,Object.assign({hideResults:this.props.hideResults},e)))):null}}N.contextType=x;class k extends n.Component{constructor(e){super(e),this.state={showResults:!1}}handleClickOutside(e){this.mount&&!0===this.mount.contains(e.target)?this.setState({showResults:!0}):this.setState({showResults:!1})}componentDidMount(){document.addEventListener("mousedown",this.handleClickOutside.bind(this)),document.addEventListener("mousedown",this.handleClickOutside.bind(this))}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside.bind(this))}render(){return r.a.createElement("div",{ref:e=>this.mount=e,id:"containerSearch"},r.a.createElement(O,null,r.a.createElement(S,null),!0===this.state.showResults&&r.a.createElement(N,{hideResults:()=>{this.setState({showResults:!1})}})))}}class _ extends r.a.Component{logOut(){this.props.dispatch({type:"CLEAR_AUTH"}),localStorage.removeItem("token"),localStorage.removeItem("refreshToken")}render(){return r.a.createElement("div",{className:"header-bar"},r.a.createElement(C.a,{to:"/"},r.a.createElement("h1",{id:"logo"},"UNIVERSHOP")),r.a.createElement(k,null),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(C.a,{to:"/cart"},r.a.createElement("img",{src:"/SVG/basket.svg",className:"icon",alt:"#"}),r.a.createElement("small",null,this.props.cart.length)),r.a.createElement("span",null,"Panier")),null===this.props.currentUser?r.a.createElement("li",null,r.a.createElement(C.a,{to:"/login"},r.a.createElement("img",{src:"/SVG/user.svg",className:"icon",alt:"#"})),r.a.createElement("span",null,"Login")):[this.props.currentUser.roles.includes("ROLE_ADMIN")&&r.a.createElement("li",null,r.a.createElement("a",{href:"/admin",target:"_blank"},r.a.createElement("img",{src:"/SVG/settings.svg",className:"icon",alt:"#"})),r.a.createElement("span",null,"Admin")),r.a.createElement(r.a.Fragment,null,r.a.createElement("li",null,r.a.createElement(C.a,{to:"/dashboard"},r.a.createElement("img",{src:"/SVG/dashboard.svg",className:"icon",alt:"#"})),r.a.createElement("span",null,"Dashboard")),r.a.createElement("li",{onClick:()=>this.logOut()},r.a.createElement("img",{src:"/SVG/logout.svg",className:"icon",id:"logout",alt:"#"}),r.a.createElement("span",null,"Logout")))]))}}var R=Object(c.connect)(e=>({cart:e.cart,currentUser:e.auth.currentUser}))(_),I=a(42),w=a(7);function D(){const e=Object(n.useRef)();Object(I.d)(()=>e.current.rotation.z+=.001);const t=(new w.TextureLoader).load("/img/galaxy2.png");return r.a.createElement("mesh",{ref:e,position:[0,1,0],"rotation-x":Math.PI/2},r.a.createElement("planeBufferGeometry",{attach:"geometry",args:[1500,1500,1]}),r.a.createElement("meshBasicMaterial",{side:w.BackSide,transparent:!0,opacity:.8,attach:"material",map:t}))}function U(e){let t=e.t;const a=Object(n.useRef)();Object(I.d)(()=>a.current.rotation.y-=.001);const s=e.iteration,o=e.floatSpread,l=e.distanceFactor,c=e.color,i=Object(n.useMemo)(()=>{let e=[];for(let a=0;a<s;a++){t++;for(let a=0;a<1e3;a++){const n=a/1e3,r=n*Math.PI+t+w.Math.randFloatSpread(o),s=w.Math.randFloatSpread(.15),c=n*l;e.push(c*Math.sin(r)*Math.cos(s)),e.push(c*Math.sin(r)*Math.sin(s)),e.push(c*Math.cos(r))}}return new Float32Array(e)},[s,o,t,l]);return r.a.createElement("points",{ref:a},r.a.createElement("bufferGeometry",{attach:"geometry"},r.a.createElement("bufferAttribute",{attachObject:["attributes","position"],array:i,count:i.length/3,itemSize:3})),r.a.createElement("pointsMaterial",{attach:"material",color:c}))}function A(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(U,{iteration:8,t:0,floatSpread:.5,distanceFactor:1e3,color:16777215}),r.a.createElement(U,{iteration:12,t:16,floatSpread:10,distanceFactor:1500,color:"#51fcff"})," // TODO",r.a.createElement(U,{iteration:8,t:8,floatSpread:.5,distanceFactor:500,color:16777215}))}var G=a(82),M=a.n(G),L=a(60);const F={hover:!1,position:new w.Vector3,zoom:!1,loadingCategories:null,loadingShops:null,categories:[],shops:[]},z=Object(n.createContext)(F),B=z.Provider,H=({children:e})=>{const t=Object(n.useReducer)((e,t)=>{if("hover"===t.type)return e.hover=t.hover,e;if("position"===t.type)return e.position=t.position,e;if("zoom"===t.type)return e.zoom=t.zoom,e;if("history"===t.type)return e.history=t.history,e;if("categoriesLoaded"===t.type)return Object(j.a)({},e,{loadingCategories:!1,categories:t.categories});if("shopsLoaded"===t.type)return Object(j.a)({},e,{loadingShops:!1,shops:t.shops,category:t.category});if("loadingCategories"===t.type)return Object(j.a)({},e,{history:t.history,loadingCategories:!0});if("loadingShops"===t.type)return Object(j.a)({},e,{history:t.history,category_id:t.category_id,loadingShops:!0});throw new Error},F),a=Object(L.a)(t,2),s=a[0],o=a[1];return r.a.createElement(B,{value:{state:s,dispatch:o}},e)};function V(){const e=Object(n.useContext)(z).state,t=Object(I.e)().camera;return Object(I.d)(()=>{!1===e.zoom?(t.position.x=M()(t.position.x,-200,.08),t.position.y=M()(t.position.y,400,.08),t.position.z=M()(t.position.z,1e3,.08)):(t.position.x=M()(t.position.x,e.position.x,.08),t.position.y=M()(t.position.y,e.position.y,.08),t.position.z=M()(t.position.z,e.position.z,.08)),t.updateProjectionMatrix()}),null}function Q(e){const t=Object(n.useContext)(z),a=t.dispatch,s=t.state,o=Object(n.useRef)(),l=(new w.TextureLoader).load("/img/flare.png"),c=t=>{"undefined"!==typeof t.preventDefault&&t.preventDefault(),s.position.setFromMatrixPosition(o.current.matrixWorld),a({type:"zoom",zoom:!0}),setTimeout((function(){s.history.push("/category/"+e.category_id)}),700)};return r.a.createElement("mesh",Object.assign({ref:o},e,{onClick:c}),r.a.createElement("planeBufferGeometry",{attach:"geometry",args:[70,70,30]}),r.a.createElement("meshBasicMaterial",{side:w.BackSide,depthTest:!1,transparent:!0,attach:"material",map:l}),r.a.createElement(I.b,null,r.a.createElement("div",{onClick:c,style:{cursor:"pointer"},className:"content-planet-sdauhsdayudash"},r.a.createElement("a",{className:"categories"},e.name))))}function q(){const e=Object(n.useRef)(),t=Object(n.useContext)(z).state;return Object(I.d)(()=>e.current.rotation.z+=.001),r.a.createElement("group",null,r.a.createElement("mesh",{ref:e,position:[0,1,0],"rotation-x":Math.PI/2},r.a.createElement("planeBufferGeometry",{attach:"geometry",args:[1,1,1]}),[{name:t.categories[0].name,category_id:t.categories[0].id,position:[400,1,-50],"rotation-z":Math.PI/2},{name:t.categories[1].name,category_id:t.categories[1].id,position:[2,300,-50],"rotation-z":Math.PI/2},{name:t.categories[2].name,category_id:t.categories[2].id,position:[30,-400,-50],"rotation-z":Math.PI/3},{name:t.categories[3].name,category_id:t.categories[3].id,position:[-300,0,-50],"rotation-z":Math.PI/4},{name:t.categories[4].name,category_id:t.categories[4].id,position:[200,200,-50],"rotation-z":Math.PI/5}].map(e=>r.a.createElement(Q,Object.assign({key:e.category_id},e)))))}function J(e){const t=Object(n.useContext)(z),a=t.dispatch;return Object(n.useEffect)(()=>{a({type:"loadingCategories",history:e.history}),fetch("".concat("/api","/categories")).then(e=>e.json()).then(e=>{a({type:"categoriesLoaded",categories:e["hydra:member"]})})},[]),!1===t.state.loadingCategories?r.a.createElement(r.a.Fragment,null,r.a.createElement(D,null),r.a.createElement(A,null),r.a.createElement(q,null),r.a.createElement(V,null)):null}var W=function(e){return r.a.createElement(I.a,{style:{position:"absolute",top:0,backgroundColor:"black",backgroundImage:"url(/img/space.jpg)"},camera:{position:[-1e3,2e3,5e3],rotation:[-.5,-.2,-.6],fov:50,near:10,far:1e4},resize:{scroll:!1}},r.a.createElement(H,null,r.a.createElement(J,{history:e.history})))};class Y extends r.a.Component{render(){return r.a.createElement(W,{history:this.props.history})}}var K=Y,X=a(1006),Z=a(593),$=()=>e=>{function t(t){const a=t.authenticating,n=t.loggedIn,s=t.error,o=Object(Z.a)(t,["authenticating","loggedIn","error"]);return a?r.a.createElement("div",null,"Logging in..."):!n||s?r.a.createElement(X.a,{to:"/login"}):r.a.createElement(e,o)}const a=e.displayName||e.name||"Component";t.displayName="RequiresLogin(".concat(a,")");return Object(c.connect)((e,t)=>({authenticating:e.auth.loading,loggedIn:null!==e.auth.currentUser,error:e.auth.error}))(t)},ee=a(33),te=a(289),ae=a.n(te),ne=a(1013),re=a(1014),se=a(1015),oe=a(1016),le=a(1017),ce=a(1018),ie=a(1019),me=a(1020),ue=a(1021),pe=a(1022),de=a(585),he=a.n(de),Ee=a(286),ge=a(287),ve=a(108),ye=a(288),fe=a(497),be=a(182),Ce=a(95);const xe=e=>r.a.createElement(ee.EditGuesser,e,r.a.createElement(ee.InputGuesser,{source:"username"}),r.a.createElement(ee.InputGuesser,{source:"email"}),r.a.createElement(Ee.a,{source:"roles"},r.a.createElement(ge.a,null,r.a.createElement(ve.a,null))),r.a.createElement(ye.a,{source:"customer",reference:"customers",filterToQuery:e=>({name:e})},r.a.createElement(fe.a,{optionText:"name"})),r.a.createElement(ye.a,{source:"merchant",reference:"merchants",filterToQuery:e=>({name:e})},r.a.createElement(fe.a,{optionText:"name"})),r.a.createElement(ye.a,{source:"seller",reference:"sellers",filterToQuery:e=>({name:e})},r.a.createElement(fe.a,{optionText:"name"}))),Oe=e=>r.a.createElement(ee.CreateGuesser,e,r.a.createElement(ee.InputGuesser,{source:"username"}),r.a.createElement(ee.InputGuesser,{source:"email",type:"email"}),r.a.createElement(ee.InputGuesser,{source:"password",type:"password"}),r.a.createElement(ee.InputGuesser,{source:"roles"}),r.a.createElement(ye.a,{source:"customer",reference:"customers",filterToQuery:e=>({name:e})},r.a.createElement(fe.a,{optionText:"name"})),r.a.createElement(ye.a,{source:"merchant",reference:"merchants",filterToQuery:e=>({name:e})},r.a.createElement(fe.a,{optionText:"name"})),r.a.createElement(ye.a,{source:"seller",reference:"sellers",filterToQuery:e=>({name:e})},r.a.createElement(fe.a,{optionText:"name"}))),Se=e=>r.a.createElement(ee.ListGuesser,e,r.a.createElement(ee.FieldGuesser,{source:"username"}),r.a.createElement(ee.FieldGuesser,{source:"email"}),r.a.createElement(ee.FieldGuesser,{source:"roles"}),r.a.createElement(be.a,{source:"customer",reference:"customers"},r.a.createElement(Ce.a,{source:"name"})),r.a.createElement(be.a,{source:"merchant",reference:"merchants"},r.a.createElement(Ce.a,{source:"name"})),r.a.createElement(be.a,{source:"seller",reference:"sellers"},r.a.createElement(Ce.a,{source:"name"}))),je=e=>r.a.createElement(ee.ShowGuesser,e,r.a.createElement(ee.FieldGuesser,{source:"id",addLabel:!0}),r.a.createElement(ee.FieldGuesser,{source:"username",addLabel:!0}),r.a.createElement(ee.FieldGuesser,{source:"email",addLabel:!0}),r.a.createElement(ee.FieldGuesser,{source:"roles",addLabel:!0}),r.a.createElement(be.a,{source:"customer",reference:"customers"},r.a.createElement(Ce.a,{source:"name"})),r.a.createElement(be.a,{source:"merchant",reference:"merchants"},r.a.createElement(Ce.a,{source:"name"})),r.a.createElement(be.a,{source:"seller",reference:"sellers"},r.a.createElement(Ce.a,{source:"name"}))),Pe=e=>ae()(e,{headers:new Headers({Authorization:"Bearer ".concat(localStorage.getItem("token"))})}).then(({api:e})=>({api:e}),e=>{switch(e.status){case 401:return Promise.resolve({api:e.api,customRoutes:[{props:{path:"/",render:()=>r.a.createElement(X.a,{to:"/login"})}}]});default:return Promise.reject(e)}}),Te=Object(ee.dataProvider)("/api",(e,t={})=>Object(ee.fetchHydra)(e,Object(j.a)({},t,{headers:new Headers({Authorization:"Bearer ".concat(localStorage.getItem("token"))})})),Pe);class Ne extends r.a.Component{render(){return!1===this.props.roles.includes("ROLE_ADMIN")?"Unauthorized access":r.a.createElement(ee.HydraAdmin,{loginPage:!1,apiDocumentationParser:Pe,dataProvider:Te,entrypoint:"/api"},r.a.createElement(ee.ResourceGuesser,{name:"carts",icon:ne.a}),r.a.createElement(ee.ResourceGuesser,{name:"cart_items",icon:re.a}),r.a.createElement(ee.ResourceGuesser,{name:"categories",icon:se.a}),r.a.createElement(ee.ResourceGuesser,{name:"customers",icon:oe.a}),r.a.createElement(ee.ResourceGuesser,{name:"merchants",icon:le.a}),r.a.createElement(ee.ResourceGuesser,{name:"products",icon:ce.a}),r.a.createElement(ee.ResourceGuesser,{name:"sellers",icon:ie.a}),r.a.createElement(ee.ResourceGuesser,{name:"seller_items",icon:me.a}),r.a.createElement(ee.ResourceGuesser,{name:"shops",icon:ue.a}),r.a.createElement(ee.ResourceGuesser,{name:"shop_items",icon:pe.a}),r.a.createElement(ee.ResourceGuesser,{name:"users",list:Se,create:Oe,edit:xe,show:je,icon:he.a}))}}var ke=$()(Object(c.connect)(e=>{const t=e.auth.currentUser;return{username:t.username,email:t.email,roles:t.roles}})(Ne));class _e extends r.a.Component{render(){return r.a.createElement("div",{className:"dashboard"},r.a.createElement("div",{className:"dashboard-username"},"Username: ",this.props.username),r.a.createElement("div",{className:"dashboard-email"},"Email: ",this.props.email),r.a.createElement(C.a,{to:"/orders"},"Orders"))}}var Re=$()(Object(c.connect)(e=>{const t=e.auth.currentUser;return{username:t.username,email:t.email,protectedData:e.protectedData.data}})(_e)),Ie=a(400),we=a(515),De=a(41);class Ue extends r.a.Component{componentDidUpdate(e){!e.meta.active&&this.props.meta.active&&this.input.focus()}render(){let e,t;return this.props.meta.touched&&this.props.meta.error&&(e=r.a.createElement("div",{className:"form-error"},this.props.meta.error)),this.props.meta.touched&&this.props.meta.warning&&(t=r.a.createElement("div",{className:"form-warning"},this.props.meta.warning)),r.a.createElement("div",{className:"form-input"},e,t,r.a.createElement("input",Object.assign({},this.props.input,{id:this.props.input.name,type:this.props.type,placeholder:this.props.placeholder,ref:e=>this.input=e})))}}a(1003);const Ae=e=>e?void 0:"Obligatoire",Ge=e=>""!==e.trim()?void 0:"Cannot be empty",Me=e=>e.trim()===e?void 0:"Cannot start or end with whitespace",Le=(Fe={min:10,max:72},e=>Fe.min&&e.length<Fe.min?"Must be at least ".concat(Fe.min," characters long"):Fe.max&&e.length>Fe.max?"Must be at most ".concat(Fe.max," characters long"):void 0);var Fe;const ze=(Be="password",(e,t)=>Be in t&&e.trim()===t[Be].trim()?void 0:"Does not match");var Be;class He extends r.a.Component{onSubmit(e){const t=e.username,a=e.email,n=e.password,r={username:t,email:a,password:n};return this.props.dispatch((e=>t=>fetch("".concat("/api","/users"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(e=>E(e)).then(e=>e.json()).catch(e=>{const t=e.reason,a=e.message,n=e.location;if("ValidationError"===t)return Promise.reject(new h.a({[n]:a}))}))(r)).then(()=>this.props.dispatch(f(a,n)))}render(){return r.a.createElement("form",{className:"login-form",onSubmit:this.props.handleSubmit(e=>this.onSubmit(e))},r.a.createElement("h2",null,"Register for Univershop"),r.a.createElement(Ie.a,{component:Ue,type:"text",placeholder:"Username",name:"username",validate:[Ae,Ge,Me]}),r.a.createElement(Ie.a,{component:Ue,type:"email",name:"email",placeholder:"Email",validate:[Ae,Ge,Me]}),r.a.createElement(Ie.a,{component:Ue,type:"password",placeholder:"Password",name:"password",validate:[Ae,Le,Me]}),r.a.createElement(Ie.a,{component:Ue,type:"password",placeholder:"Confirm password",name:"passwordConfirm",validate:[Ae,Ge,ze]}),r.a.createElement("button",{type:"submit",disabled:this.props.pristine||this.props.submitting},"Register"))}}var Ve=Object(we.a)({form:"registration",onSubmitFail:(e,t)=>t(Object(De.c)("registration",Object.keys(e)[0]))})(He);var Qe=Object(c.connect)(e=>({loggedIn:null!==e.auth.currentUser}))((function(e){return e.loggedIn?r.a.createElement(X.a,{to:"/dashboard"}):r.a.createElement("div",{className:"home"},r.a.createElement(Ve,null))}));class qe extends r.a.Component{onSubmit(e){return this.props.dispatch(f(e.email,e.password))}render(){let e;return this.props.error&&(e=r.a.createElement("div",{className:"form-error","aria-live":"polite"},this.props.error)),r.a.createElement("form",{className:"login-form",onSubmit:this.props.handleSubmit(e=>this.onSubmit(e))},r.a.createElement("h2",null,"Login for Univershop"),e,r.a.createElement(Ie.a,{component:Ue,type:"text",name:"email",placeholder:"Email",id:"email",validate:[Ae,Ge]}),r.a.createElement(Ie.a,{component:Ue,type:"password",name:"password",placeholder:"Password",id:"password",validate:[Ae,Ge]}),r.a.createElement("div",{className:"form-bottom"},r.a.createElement("button",{disabled:this.props.pristine||this.props.submitting},"Log in"),r.a.createElement(C.a,{to:"/register"},"Pas encore inscrit ?")))}}var Je=Object(we.a)({form:"login",onSubmitFail:(e,t)=>t(Object(De.c)("login","email"))})(qe);var We=Object(c.connect)(e=>({loggedIn:null!==e.auth.currentUser}))((function(e){return e.loggedIn?r.a.createElement(X.a,{to:"/dashboard"}):r.a.createElement("div",{className:"home"},r.a.createElement(Je,null))})),Ye=a(586),Ke=a(594),Xe=a(591),Ze=a(587);function $e(){const e=Object(n.useRef)();Object(I.d)(()=>e.current.rotation.y+=.002);const t=(new w.TextureLoader).load("/img/2k_sun.jpg");return r.a.createElement("mesh",{ref:e,position:[0,1,0],"rotation-y":Math.PI/2},r.a.createElement("sphereGeometry",{attach:"geometry",args:[100,100,100]}),r.a.createElement("meshBasicMaterial",{attach:"material",map:t}))}function et(e){const t=Object(n.useContext)(z),a=t.dispatch,s=t.state,o=Object(n.useRef)(),l=t=>{"undefined"!==typeof t.preventDefault&&t.preventDefault(),s.position.setFromMatrixPosition(o.current.matrixWorld),a({type:"zoom",zoom:!0}),setTimeout((function(){s.history.push("/category/"+s.category_id+"/shop/"+e.shop_id)}),700)};return r.a.createElement("mesh",Object.assign({"rotation-y":Math.PI/2,ref:o,onClick:l},e),r.a.createElement("sphereGeometry",{attach:"geometry",args:[(c=20,i=40,Math.floor(Math.random()*(i-c+1))+c),20,30]}),r.a.createElement("meshLambertMaterial",{attach:"material",color:"grey"}),r.a.createElement(I.b,null,r.a.createElement("div",{onClick:l,style:{cursor:"pointer"},className:"content-planet-sdauhsdayudash"},r.a.createElement("a",{className:"categories"},e.shop_name))));var c,i}function tt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function at(e){const t=Object(n.useContext)(z).state,a=Object(n.useRef)();return Object(I.d)(()=>{!1===t.hover&&(a.current.rotation.z+=.002)}),r.a.createElement("group",null,r.a.createElement("mesh",{ref:a,position:[0,1,0],"rotation-x":Math.PI/2},r.a.createElement("planeBufferGeometry",{attach:"geometry",args:[1,1,1]}),t.shops.map(t=>r.a.createElement(et,Object.assign({key:t.id,shop_id:t.id,shop_name:t.name,position:[tt(400,-400),tt(400,-400),0]},e)))))}function nt(){const e=Object(n.useContext)(z).state,t=Object(I.e)().camera;return Object(I.d)(()=>{!1===e.zoom?(t.position.x=M()(t.position.x,-150,.08),t.position.y=M()(t.position.y,300,.08),t.position.z=M()(t.position.z,750,.08)):(t.position.x=M()(t.position.x,e.position.x,.08),t.position.y=M()(t.position.y,e.position.y,.08),t.position.z=M()(t.position.z,e.position.z,.08)),t.updateProjectionMatrix()}),null}function rt(e){const t=Object(n.useContext)(z),a=t.dispatch;return Object(n.useEffect)(()=>{a({type:"loadingShops",history:e.history,category_id:e.category_id}),fetch("".concat("/api","/shops?category=").concat(e.category_id)).then(e=>e.json()).then(e=>{a({type:"shopsLoaded",shops:e["hydra:member"]})})},[]),!1===t.state.loadingShops?r.a.createElement(r.a.Fragment,null,r.a.createElement("pointLight",{position:[1,1,1]}),r.a.createElement("ambientLight",{intensity:.2}),r.a.createElement($e,null),r.a.createElement(at,null),r.a.createElement(nt,null)):null}Object(I.c)({OrbitControls:Ye.a,UnrealBloomPass:Ke.a,EffectComposer:Xe.a,RenderPass:Ze.a});var st=function(e){return r.a.createElement(I.a,{onCreated:({camera:e})=>e.lookAt(0,0,0),style:{position:"absolute",top:0,backgroundImage:"url(/img/space.jpg)"},camera:{position:[-1e3,2e3,5e3],fov:50,near:100,far:5e3},resize:{scroll:!1}},r.a.createElement(H,null,r.a.createElement(rt,{history:e.history,category_id:e.category_id})))};class ot extends r.a.Component{render(){return r.a.createElement(st,{history:this.props.history,category_id:this.props.match.params.id})}}var lt=a(89),ct=a.n(lt),it=a(588),mt=a(592);class ut extends r.a.Component{constructor(e){super(e),this.setSortBy=e=>{this.setState({sortBy:e})},this.toggleDirection=()=>{this.setState({direction:"asc"===this.state.direction?"desc":"asc"})},this.goToPage=e=>{this.setState({activePage:e})},this.prevPage=()=>{this.setState(({activePage:e})=>({activePage:e-1}))},this.nextPage=()=>{this.setState(({activePage:e})=>({activePage:e+1}))},this.state={shopItems:[],loading:null,sortBy:"name",direction:"asc",activePage:0,searchQuery:""}}componentDidMount(){var e=this;return Object(it.a)(ct.a.mark((function t(){var a,n,r,s,o;return ct.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),a=e=>fetch(e).then(e=>e.json()),t.next=4,Promise.all([a("".concat("/api","api/shops/").concat(e.props.match.params.shop_id)),a("".concat("/api","/shop_items?shop=").concat(e.props.match.params.shop_id))]);case 4:n=t.sent,r=Object(L.a)(n,2),s=r[0],o=r[1],e.setState({loading:!1,shop:s,shopItems:o["hydra:member"]});case 9:case"end":return t.stop()}}),t)})))()}addCart(e){this.props.dispatch({type:"ADD_PRODUCT",product:Object(j.a)({},e,{quantity:1})})}render(){const e=this.state,t=e.sortBy,a=e.direction,n=e.activePage,s=e.searchQuery;return!1===this.state.loading?this.state.shopItems.length>=1?r.a.createElement(mt.a,{data:this.state.shopItems,sortBy:t,direction:a,activePage:n,searchQuery:s,paginate:!0,render:({data:e,pages:s})=>r.a.createElement("div",null,r.a.createElement(pt,{setSortBy:this.setSortBy,sortBy:t,direction:a,toggleDirection:this.toggleDirection}),r.a.createElement("h2",null,this.state.shop.name),r.a.createElement(ht,{data:e,addCart:this.addCart.bind(this)}),r.a.createElement(Et,{style:{justifyContent:"space-between"}},r.a.createElement(gt,{goToPage:this.goToPage,pages:s}),r.a.createElement(yt,{pages:s,activePage:n}),r.a.createElement(vt,{activePage:n,goToPage:this.goToPage,nextPage:this.nextPage,prevPage:this.prevPage,pages:s})))}):"Ce shop n'a pas de produit en vente actuellement":!0===this.state.loading?"Loading...":null}}function pt({setSortBy:e,sortBy:t,direction:a,toggleDirection:n}){const s=[{key:"id",title:"ID"},{key:"name",title:"Name"},{key:"description",title:"Description"},{key:"price",title:"Price"}].map(({key:s,title:o})=>{const l=s===t;return r.a.createElement(dt,{key:s,active:l,onClick:()=>{l&&n(),e(s)}},o," ",l?"asc"===a?"\u25b2":"\u25bc":null)});return r.a.createElement("div",{style:{display:"grid",gridGap:"5px",gridAutoflow:"column"}},r.a.createElement("div",null,"Sort by"),s)}function dt({children:e,active:t,onClick:a}){return r.a.createElement("div",{onClick:a,style:{fontWeight:t?"bold":"normal",cursor:"pointer"}},e)}function ht({data:e,addCart:t}){return r.a.createElement("section",{id:"productList"},e.map(({product:e})=>r.a.createElement("div",{key:e.id,class:"containerProductList"},r.a.createElement("img",{src:"https://fakeimg.pl/100x100/282828/F2F4F3",style:{width:100,height:100},alt:e.name}),r.a.createElement("h2",null,r.a.createElement(C.a,{to:"/product/".concat(e.id)},e.name)),r.a.createElement("p",null,e.description),r.a.createElement("h3",null,e.price," \u20ac"),r.a.createElement("button",{className:"addToCart",onClick:()=>t(e)},r.a.createElement("img",{src:"/SVG/basket.svg",style:{width:15,height:15},alt:e.name}),"Ajouter au panier"))))}function Et({children:e,style:t}){return r.a.createElement("div",{style:Object(j.a)({display:"flex"},t)},e)}function gt({goToPage:e,pages:t}){const a=[];for(let n=0;n<t;n++)a.push(r.a.createElement("option",{key:n,value:n},n+1));return r.a.createElement("div",null,"Go to page"," ",r.a.createElement("select",{onChange:t=>e(parseInt(t.target.value))},a))}function vt({activePage:e=0,goToPage:t,nextPage:a,prevPage:n,pages:s}){return r.a.createElement(Et,null,r.a.createElement("button",{disabled:0===e,onClick:()=>t(0)},"<<"),r.a.createElement("button",{disabled:0===e,onClick:n},"<"),r.a.createElement("button",{disabled:e===s-1,onClick:a},">"),r.a.createElement("button",{disabled:e===s-1,onClick:()=>t(s-1)},">>"))}function yt({pages:e,activePage:t=0}){return r.a.createElement("div",null,r.a.createElement("b",null,t+1)," / ",e)}var ft=Object(c.connect)()(ut);a(1004);class bt extends r.a.Component{render(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"about"},r.a.createElement("a",{class:"bg_links social portfolio",href:"https://www.rafaelalucas.com",rel:"noopener noreferrer",target:"_blank"},r.a.createElement("span",{class:"icon"})),r.a.createElement("a",{class:"bg_links social dribbble",href:"https://dribbble.com/rafaelalucas",rel:"noopener noreferrer",target:"_blank"},r.a.createElement("span",{class:"icon"})),r.a.createElement("a",{class:"bg_links social linkedin",href:"https://www.linkedin.com/in/rafaelalucas/",rel:"noopener noreferrer",target:"_blank"},r.a.createElement("span",{class:"icon"})),r.a.createElement("a",{class:"bg_links logo"})),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"planet"},r.a.createElement("div",{className:"ring"}),r.a.createElement("div",{className:"cover-ring"}),r.a.createElement("div",{className:"spots"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null))),r.a.createElement("p",null,"loading")))}}class Ct extends r.a.Component{constructor(e){super(e),this.state={loading:null,productdetail:[]}}componentDidUpdate(e){this.props.match.params.product_id!==e.match.params.product_id&&this.fetchCart()}componentDidMount(){this.fetchCart()}fetchCart(){this.setState({loading:!0}),fetch("".concat("/api","/products?id=").concat(this.props.match.params.product_id)).then(e=>e.json()).then(e=>{this.setState({loading:!1,productdetail:e["hydra:member"]})})}addCart(e){this.props.dispatch({type:"ADD_PRODUCT",product:Object(j.a)({},e,{quantity:1})})}render(){if(!1===this.state.loading){const e=this.state.productdetail.map(e=>r.a.createElement("div",{key:e.id},r.a.createElement("h2",null,e.name),r.a.createElement("h4",null,e.description),r.a.createElement("h4",null,e.price),r.a.createElement("h4",null,e.images),r.a.createElement("h4",null,console.log(e.images)),r.a.createElement("button",{className:"addToCart",onClick:()=>this.addCart(e)},"Ajouter au panier")));return r.a.createElement(r.a.Fragment,null,e)}return r.a.createElement(bt,null)}}var xt=Object(c.connect)()(Ct);class Ot extends r.a.Component{render(){return r.a.createElement("div",{className:"Product"},r.a.createElement("div",{style:{width:100,textAlign:"center"}},r.a.createElement("img",{src:"https://fakeimg.pl/100x100/282828/F2F4F3",alt:this.props.product.name,style:{borderRadius:15}}),r.a.createElement("div",{className:"itemsQuantity"},r.a.createElement("img",{src:"/SVG/minus-solid.svg",onClick:()=>{this.props.dispatch({type:"DELETE_PRODUCT",product:this.props.product})},className:"icon minus",alt:"#"}),r.a.createElement("p",null,this.props.product.quantity),r.a.createElement("img",{src:"/SVG/plus-solid.svg",onClick:()=>{this.props.dispatch({type:"ADD_PRODUCT",product:this.props.product})},className:"icon add",alt:"#"}))),r.a.createElement("div",{className:"Content"},r.a.createElement("h1",null,this.props.product.name),r.a.createElement("p",null,this.props.product.description),r.a.createElement("p",{style:{fontSize:"0.9rem"}},r.a.createElement("strong",null,"Prix unit\xe9 : ")," ",this.props.product.price," \u20ac"),r.a.createElement("p",null,r.a.createElement("strong",null,"Sous total : "),this.props.product.price*this.props.product.quantity," \u20ac")))}}var St=Object(c.connect)((e,t)=>Object(j.a)({},t))(Ot);class jt extends r.a.Component{render(){let e=this.props.shopItems.map(e=>e.price*e.quantity).reduce((e,t)=>e+t);return r.a.createElement("div",null,r.a.createElement("h2",null,"TOTAL"),r.a.createElement("h3",null,"Livraison :"),r.a.createElement("h3",null,"Total \xe0 payer : ",e," \u20ac"),r.a.createElement(C.a,{to:"/checkout"},r.a.createElement("button",{className:"payment"},"Payment")),r.a.createElement("div",{id:"credit-cards"},r.a.createElement("img",{src:"/SVG/credit-card-maestro.svg",alt:"credit-card-maestro",style:{width:"40px"},className:"credit-card"}),r.a.createElement("img",{src:"/SVG/credit-card-master.svg",alt:"credit-card-master",style:{width:"40px"},className:"credit-card"}),r.a.createElement("img",{src:"/SVG/credit-card-american-express.svg",alt:"credit-card-american-express",style:{width:"50px"},className:"credit-card"}),r.a.createElement("img",{src:"/SVG/credit-card-visa.svg",alt:"credit-card-visa",style:{width:"60px"},className:"credit-card"}),r.a.createElement("img",{src:"/SVG/credit-card-paypal.svg",alt:"credit-card-paypal",style:{width:"70px"},className:"credit-card"})))}}var Pt=Object(c.connect)((e,t)=>Object(j.a)({},t))(jt);class Tt extends r.a.Component{render(){if(this.props.cart.length>0){let e=this.props.cart.map((e,t,a)=>Object(j.a)({},e,{quantity:a.filter(t=>e.id===t.id).length}));return e=e.filter((e,t,a)=>t===a.findIndex(t=>e.id===t.id)),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"Cart-Left"},r.a.createElement("h2",null,"MON PANIER"),r.a.createElement("div",{className:"items"},e.map(e=>r.a.createElement(St,{product:Object(j.a)({},e),key:e.id})))),r.a.createElement("div",{className:"Cart-Right"},r.a.createElement(Pt,{shopItems:e})))}return r.a.createElement("div",{className:"cart-error","aria-live":"polite"},r.a.createElement("h3",null,"Ton panier est vide :/"),r.a.createElement("p",null,"Gooo voyager sur nos principales planete afin de trouver ton bonheur :)"),r.a.createElement(C.a,{to:"/"},r.a.createElement("button",null,"C'est partit !")))}}var Nt=Object(c.connect)(e=>({cart:e.cart}))(Tt);class kt extends r.a.Component{render(){return r.a.createElement("div",{className:"cart"},r.a.createElement(Nt,null))}}const _t=Object(n.createContext)();class Rt extends n.Component{constructor(e){super(e),this.state={cartItems:JSON.parse(localStorage.getItem("cart")),step:0,customer:{},shipping:{},nextStep:e=>{0===this.state.step&&(this.state.customer=e),1===this.state.step&&(this.state.shipping=e),this.setState(e=>({step:e.step+1}))},previousStep:()=>this.setState(e=>({step:e.step-1})),setShippingData:e=>this.setState(()=>({shipping:e})),setCustomerData:e=>this.setState(()=>({customer:e}))}}render(){return r.a.createElement(_t.Provider,{value:this.state},this.props.children)}}class It extends r.a.Component{constructor(e,t){super(e,t),this.state={firstname:"",lastname:"",address:"",cardNumber:null,cvv:null,expiryMonth:null,expiryYear:null}}postData(e){e.preventDefault(),this.context.nextStep(this.state)}handleChange(e){this.setState({[e.target.name]:e.target.value})}render(){return r.a.createElement("form",{onSubmit:this.postData.bind(this)},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"info"},r.a.createElement("label",{for:"firstname"},"Prenom"),r.a.createElement("input",{value:this.state.firstname,onChange:this.handleChange.bind(this),name:"firstname",id:"firstname",type:"text"}),r.a.createElement("label",{for:"lastname"},"Nom"),r.a.createElement("input",{value:this.state.lastname,onChange:this.handleChange.bind(this),name:"lastname",id:"lastname",type:"text"}),r.a.createElement("label",{for:"address"},"Adresse"),r.a.createElement("input",{value:this.state.address,onChange:this.handleChange.bind(this),name:"address",id:"address",type:"text"})),r.a.createElement("div",{className:"card__container"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"row credit"},r.a.createElement("div",{className:"left"},r.a.createElement("label",{for:"cd"},"Debit/ Credit Card")),r.a.createElement("div",{className:"right"})),r.a.createElement("div",{className:"row cardholder"},r.a.createElement("div",{className:"info"},r.a.createElement("label",{for:"cardholdername"},"Name"),r.a.createElement("input",{value:this.state.cardholdername,onChange:this.handleChange.bind(this),placeholder:"e.g. Richard Bovell",id:"cardholdername",type:"text"}))),r.a.createElement("div",{className:"row number"},r.a.createElement("div",{className:"info"},r.a.createElement("label",{for:"cardnumber"},"Card number"),r.a.createElement("input",{value:this.state.cardNumber,onChange:this.handleChange.bind(this),name:"cardNumber",id:"cardNumber",type:"text",pattern:"[0-9]{16,19}",maxlength:"19",placeholder:"8888-8888-8888-8888"}))),r.a.createElement("div",{className:"row details"},r.a.createElement("div",{className:"left"},r.a.createElement("label",{for:"expiry-date"},"Expiry"),r.a.createElement("select",{value:this.state.expiryMonth,onChange:this.handleChange.bind(this),name:"expiryMonth",id:"expiry-date"},r.a.createElement("option",null,"MM"),r.a.createElement("option",{value:"1"},"01"),r.a.createElement("option",{value:"2"},"02"),r.a.createElement("option",{value:"3"},"03"),r.a.createElement("option",{value:"4"},"04"),r.a.createElement("option",{value:"5"},"05"),r.a.createElement("option",{value:"6"},"06"),r.a.createElement("option",{value:"7"},"07"),r.a.createElement("option",{value:"8"},"08"),r.a.createElement("option",{value:"9"},"10"),r.a.createElement("option",{value:"11"},"11"),r.a.createElement("option",{value:"12"},"12")),r.a.createElement("span",null,"/"),r.a.createElement("select",{value:this.state.expiryYear,onChange:this.handleChange.bind(this),name:"expiryYear",id:"expiry-date"},r.a.createElement("option",null,"YYYY"),r.a.createElement("option",{value:"2016"},"2016"),r.a.createElement("option",{value:"2017"},"2017"),r.a.createElement("option",{value:"2018"},"2018"),r.a.createElement("option",{value:"2019"},"2019"),r.a.createElement("option",{value:"2020"},"2020"),r.a.createElement("option",{value:"2021"},"2021"),r.a.createElement("option",{value:"2022"},"2022"),r.a.createElement("option",{value:"2023"},"2023"),r.a.createElement("option",{value:"2024"},"2024"),r.a.createElement("option",{value:"2025"},"2025"),r.a.createElement("option",{value:"2026"},"2026"),r.a.createElement("option",{value:"2027"},"2027"),r.a.createElement("option",{value:"2028"},"2028"),r.a.createElement("option",{value:"2029"},"2029"),r.a.createElement("option",{value:"2030"},"2030"))),r.a.createElement("div",{className:"right"},r.a.createElement("label",{for:"cvv"},"CVC/CVV"),r.a.createElement("input",{value:this.state.cvv,onChange:this.handleChange.bind(this),name:"cvv",type:"text",maxlength:"4",placeholder:"123"}),r.a.createElement("span",{"data-balloon-length":"medium","data-balloon":"The 3 or 4-digit number on the back of your card.","data-balloon-pos":"up"},"i"))))),r.a.createElement("div",{className:"button"},r.a.createElement("button",null,"Suivant"))))}}It.contextType=_t;class wt extends n.Component{constructor(e,t){super(e,t),this.state={courier:"relais"}}postData(e){e.preventDefault(),this.context.nextStep(this.state)}handleChange(e){this.setState({[e.target.name]:e.target.value})}render(){return r.a.createElement("form",{onSubmit:this.postData.bind(this)},r.a.createElement("label",null,"Frais de port"),r.a.createElement("div",null,r.a.createElement("label",{for:"relais"},"Relais",r.a.createElement("input",{id:"relais",checked:"relais"===this.state.courier,onChange:this.handleChange.bind(this),name:"courier",type:"radio",value:"relais"})),r.a.createElement("label",{for:"standard"},"Standard",r.a.createElement("input",{id:"standard",checked:"standard"===this.state.courier,onChange:this.handleChange.bind(this),name:"courier",type:"radio",value:"standard"})),r.a.createElement("label",{for:"express"},"Express",r.a.createElement("input",{id:"express",checked:"express"===this.state.courier,onChange:this.handleChange.bind(this),name:"courier",type:"radio",value:"express"}))),r.a.createElement("button",null,"Suivant"))}}wt.contextType=_t;class Dt extends r.a.Component{confirm(e){e.preventDefault();let t=JSON.parse(localStorage.getItem("orders"));null===t&&(t=[]),t.push(this.context),localStorage.setItem("orders",JSON.stringify(t))}render(){let e=this.context.cartItems.map(e=>e.price*e.quantity).reduce((e,t)=>e+t);return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.confirm.bind(this)},r.a.createElement("h4",null,"Detaille de Votre Command"),r.a.createElement("div",null,"Prenom: ",this.context.customer.firstname),r.a.createElement("div",null,"Nom: ",this.context.customer.lastname),r.a.createElement("div",null,"Address: ",this.context.customer.address),r.a.createElement("div",null,"Type de livraison: ",this.context.shipping.courier),r.a.createElement("div",null,r.a.createElement("h4",null,"Resume du Panier"),this.context.cartItems.map(e=>r.a.createElement("div",null,r.a.createElement("span",null,r.a.createElement("strong",null,"Nom de Produit : ")," ",e.name),r.a.createElement("br",null),r.a.createElement("span",null,r.a.createElement("strong",null,"Prix unit\xe9: ")," ",e.price," \u20ac"),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("strong",null,"x : "),e.quantity))),r.a.createElement("div",null,r.a.createElement("strong",null,"Prix total : "),e," \u20ac")),r.a.createElement("div",{className:"button"},r.a.createElement("button",null,"Confirm and Pay"))))}}Dt.contextType=_t;var Ut=Object(c.connect)((e,t)=>Object(j.a)({},t))(Dt);class At extends n.Component{render(){return r.a.createElement(Rt,null,r.a.createElement(_t.Consumer,null,e=>r.a.createElement("div",null,0===e.step&&r.a.createElement(It,null),1===e.step&&r.a.createElement(wt,null),2===e.step&&r.a.createElement(Ut,null),e.step>0&&r.a.createElement("button",{onClick:()=>e.previousStep()},"Previous"))))}}At.contextType=_t;var Gt=Object(c.connect)(e=>({user:e.auth.currentUser}))(At);class Mt extends r.a.Component{render(){let e=JSON.parse(localStorage.getItem("orders"));return null===e&&(e=[]),r.a.createElement("div",null,r.a.createElement("h2",null,"Detail de commande :"),e.map(e=>r.a.createElement("div",null,e.cartItems.map(e=>r.a.createElement("div",null,r.a.createElement("h4",null,"Nom produit : ",e.name),r.a.createElement("h4",null,"Description : ",e.description),r.a.createElement("h4",null,"Prix : ",e.price,"  \u20ac"),r.a.createElement("h4",null,e.images),r.a.createElement("h4",null,"Quantite : ",e.quantity))),r.a.createElement("h2",null,"Shipping :"),r.a.createElement("h4",null,"Service postal : ",e.shipping.shippingType),r.a.createElement("h2",null,"Customer :"),r.a.createElement("h4",null,"Nom : ",e.customer.firstname),r.a.createElement("h4",null,"Prenom : ",e.customer.lastname),r.a.createElement("h4",null,"Addres : ",e.customer.address))),";")}}Mt.contextType=_t;var Lt=$()(Object(c.connect)(e=>({loggedIn:null!==e.auth.currentUser}))(Mt));class Ft extends r.a.Component{componentDidUpdate(e){!e.loggedIn&&this.props.loggedIn?this.startPeriodicRefresh():e.loggedIn&&!this.props.loggedIn&&this.stopPeriodicRefresh()}componentWillUnmount(){this.stopPeriodicRefresh()}startPeriodicRefresh(){this.refreshInterval=setInterval(()=>this.props.dispatch(b()),36e5)}stopPeriodicRefresh(){this.refreshInterval&&clearInterval(this.refreshInterval)}render(){return r.a.createElement(i.a,null,r.a.createElement(m.a,{exact:!0,path:"/admin",component:ke}),r.a.createElement(r.a.Fragment,null,r.a.createElement(R,null),r.a.createElement(i.a,null,r.a.createElement(m.a,{exact:!0,path:"/",component:K}),r.a.createElement(m.a,{exact:!0,path:"/register",component:Qe}),r.a.createElement(m.a,{exact:!0,path:"/login",component:We}),r.a.createElement(m.a,{exact:!0,path:"/dashboard",component:Re}),r.a.createElement(m.a,{exact:!0,path:"/category/:id",component:ot}),r.a.createElement(m.a,{exact:!0,path:"/category/:cat_id/shop/:shop_id",component:ft}),r.a.createElement(m.a,{exact:!0,path:"/product/:product_id",component:xt}),r.a.createElement(m.a,{exact:!0,path:"/cart",component:kt}),r.a.createElement(m.a,{exact:!0,path:"/checkout",component:Gt}),r.a.createElement(m.a,{exact:!0,path:"/orders",component:Lt}),r.a.createElement(m.a,null,r.a.createElement("div",null,"404 Not found")))))}}var zt=Object(u.a)(Object(c.connect)(e=>({hasAuthToken:null!==e.auth.authToken,loggedIn:null!==e.auth.currentUser}))(Ft)),Bt=a(48),Ht=a(402),Vt=a(590);const Qt={token:null,currentUser:null,loading:!1,error:null};const qt={data:"",error:null};const Jt=localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")):[],Wt=Object(Bt.d)(Object(Bt.c)({cart:function(e=[],t){if("ADD_PRODUCT"===t.type)return[...e,t.product];if("DELETE_PRODUCT"===t.type){let a=e.findIndex(e=>e.id===t.product.id);return e.splice(a,1),[...e]}return e},form:Ht.a,auth:function(e=Qt,t){return"SET_AUTH_TOKEN"===t.type?Object.assign({},e,{token:t.token,refreshToken:t.refreshToken}):"CLEAR_AUTH"===t.type?Object.assign({},e,{token:null,refreshToken:null,currentUser:null}):"AUTH_REQUEST"===t.type?Object.assign({},e,{loading:!0,error:null}):"AUTH_SUCCESS"===t.type?Object.assign({},e,{loading:!1,currentUser:t.currentUser}):"AUTH_ERROR"===t.type?Object.assign({},e,{loading:!1,error:t.error}):e},protectedData:function(e=qt,t){return"FETCH_PROTECTED_DATA_SUCCESS"===t.type?Object.assign({},e,{data:t.data,error:null}):"FETCH_PROTECTED_DATA_ERROR"===t.type?Object.assign({},e,{error:t.error}):e}}),{cart:Jt},Object(Bt.a)(Vt.a));Wt.subscribe(e=>{localStorage.setItem("cart",JSON.stringify(Wt.getState().cart))});const Yt=localStorage.getItem("token"),Kt=localStorage.getItem("refresh_token");Yt&&(Wt.dispatch(g(Yt,Kt)),Wt.dispatch(b()));var Xt=Wt;o.a.render(r.a.createElement(c.Provider,{store:Xt},r.a.createElement(l.a,{basename:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_API_URL:"/api"}).REACT_APP_PUBLIC_URL},r.a.createElement(zt,null))),document.getElementById("root"))},614:function(e,t,a){e.exports=a(1005)},967:function(e,t){},972:function(e,t){},984:function(e,t){},985:function(e,t){}},[[614,1,2]]]);
//# sourceMappingURL=main.162f63ab.chunk.js.map